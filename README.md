# AudioTrauma

Это REST API для сервиса хранения и прослушивания аудиофайлов с поддержкой пользователей, плейлистов, лайков, комментариев, истории прослушиваний, поиска и административных функций.  
API покрыт автотестами в Postman (см. раздел "Автотесты").

---

## Быстрый старт

1. Клонируйте репозиторий и установите зависимости:
    ```bash
    npm install
    ```
2. Создайте файл `.env` и укажите переменные:
    ```
    MONGO_URI=your_mongodb_uri
    JWT_SECRET=your_jwt_secret
    ```
3. Запустите сервер:
    ```bash
    npm start
    ```
4. Сервер будет доступен на `http://localhost:5000`

---

## Эндпоинты

### Аутентификация и пользователи

* POST /auth/register — регистрация пользователя
* POST /auth/login — вход пользователя
* POST /auth/logout — выход пользователя
* GET /users/me — информация о текущем пользователе
* PUT /users/me — обновить данные профиля
* DELETE /users/me — удалить аккаунт

---

### Аудиофайлы

* POST /audio/upload — загрузить аудиофайл
* GET /audio — получить список аудиофайлов пользователя
* GET /audio/:id — получить информацию о файле
* GET /audio/:id/stream — потоковое воспроизведение
* PUT /audio/:id — обновить метаданные файла
* DELETE /audio/:id — удалить файл
* POST /audio/:id/like — лайкнуть аудиофайл
* DELETE /audio/:id/like — убрать лайк
* POST /audio/:id/comment — добавить комментарий
* GET /audio/:id/comments — получить комментарии

---

### Плейлисты

* POST /playlists — создать плейлист
* GET /playlists — получить свои плейлисты
* GET /playlists/:id — детали плейлиста
* PUT /playlists/:id — обновить плейлист
* DELETE /playlists/:id — удалить плейлист
* POST /playlists/:id/add — добавить аудио в плейлист
* DELETE /playlists/:id/remove — убрать аудио из плейлиста

---

### История и рекомендации

* GET /history — история прослушивания
* DELETE /history — очистить историю
* GET /history/recommendations — рекомендации аудио

---

### Поиск

* GET /search/audio?q=текст — поиск аудиофайлов
* GET /search/users?q=текст — поиск пользователей

---

### Администрирование

* GET /admin/audio — список всех аудиофайлов (для модерации)
* DELETE /admin/audio/:id — удалить любой аудиофайл

---

## Авторизация

Большинство эндпоинтов требуют JWT-токен в заголовке:
```
Authorization: Bearer <token>
```
Токен можно получить через `/auth/login`.

---

## Автотесты (Postman)

В репозитории есть коллекция Postman с автотестами для всех основных сценариев

AudioTrauma.postman_collection

**Как использовать:**
1. Импортируйте коллекцию в Postman.
2. Запустите Runner — все тесты выполнятся автоматически.
3. Для каждого запроса реализованы проверки статусов и структуры ответа.
![image](https://github.com/user-attachments/assets/0fe46062-f198-41db-b88e-ae7e95b48505)

---
